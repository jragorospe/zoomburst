<!DOCTYPE html>
<meta charset="utf-8">
<style>
    path {
        stroke: #fff;
    }
</style>
<input type="text" id="fname" name="fname"><br><br>
<button type="button" onclick="updateData()">Update</button>
<select id="Countries" onchange="updateData()">
    <option value="Australia">Australia</option>
    <option value="Bangladesh">Bangladesh</option>
    <option value="Brazil">Brazil</option>
    <option value="Cambodia">Cambodia</option>
    <option value="Canada">Canada</option>
    <option value="China">China</option>
    <option value="Columbia">Columbia</option>
    <option value="Dubai">Dubai</option>
    <option value="Estonia">Estonia</option>
    <option value="Fiji">Fiji</option>
    <option value="Finland">Finland</option>
    <option value="France">France</option>
    <option value="Germany">Germany</option>
    <option value="Ghana">Ghana</option>
    <option value="Holland">Holland</option>
    <option value="HongKong">Hong Kong</option>
    <option value="Hungary">Hungary</option>
    <option value="India">India</option>
    <option value="Indonesia">Indonesia</option>
    <option value="Italy">Italy</option>
    <option value="Japan">Japan</option>
    <option value="Malaysia">Malaysia</option>
    <option value="Mexico">Mexico</option>
    <option value="Myanmar">Myanmar</option>
    <option value="Nepal">Nepal</option>
    <option value="Netherlands">Netherlands</option>
    <option value="NewZealand">New Zealand</option>
    <option value="Nigeria">Nigeria</option>
    <option value="Pakistan">Pakistan</option>
    <option value="Peru">Peru</option>
    <option value="Philippines">Philippines</option>
    <option value="Poland">Poland</option>
    <option value="Portugal">Portugal</option>
    <option value="Russia">Russia</option>
    <option value="Sarawak">Sarawak</option>
    <option value="Singapore">Singapore</option>
    <option value="SouthKorea">South Korea</option>
    <option value="Spain">Spain</option>
    <option value="Sweden">Sweden</option>
    <option value="Taiwan">Taiwan</option>
    <option value="Thailand">Thailand</option>
    <option value="UK">UK</option>
    <option value="Ukraine">Ukraine</option>
    <option value="USA">USA</option>
    <option value="Vietnam">Vietnam</option>
    <option value="ramen">World</option>
</select>
<body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

    var width = 960,
        height = 700,
        radius = (Math.min(width, height) / 2) - 10;

    var formatNumber = d3.format(",d");

    var x = d3.scaleLinear()
        .range([0, 2 * Math.PI]);

    var y = d3.scaleLinear()
        .range([0, radius]);

    var color = d3.scaleOrdinal(d3.schemeCategory20);

    var partition = d3.partition();

    var arc = d3.arc()
        .startAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x0))); })
        .endAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x1))); })
        .innerRadius(function(d) { return Math.max(0, y(d.y0)); })
        .outerRadius(function(d) { return Math.max(0, y(d.y1)); });


    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", "translate(" + width / 2 + "," + (height / 2) + ")");

    d3.json("ramen.json", function(error, root) {
        if (error) throw error;

        root = d3.hierarchy(root);
        root.sum(function(d) { return d.values; });
        svg.selectAll("path")
            .data(partition(root).descendants())
            .enter().append("path")
            .attr("d", arc)
            .style("fill", function(d) { return color((d.children ? d : d.parent).data.name); })
            .on("click", click)
            .append("title")
            .text(function(d) { return d.data.name + "\n" + formatNumber(d.value); });
    });

    function click(d) {
        svg.transition()
            .duration(750)
            .tween("scale", function() {
                var xd = d3.interpolate(x.domain(), [d.x0, d.x1]),
                    yd = d3.interpolate(y.domain(), [d.y0, 1]),
                    yr = d3.interpolate(y.range(), [d.y0 ? 20 : 0, radius]);
                return function(t) { x.domain(xd(t)); y.domain(yd(t)).range(yr(t)); };
            })
            .selectAll("path")
            .attrTween("d", function(d) { return function() { return arc(d); }; });
    }

    function updateData() {
        var cString = document.getElementById('Countries');
        var selectedText = cString.options[cString.selectedIndex].value;
        var countryFile = selectedText.concat(".json");
        var txtBox = document.getElementById("fname");
        txtBox.value = countryFile;

        d3.json(countryFile, function (error, root) {
            if (error) throw error;

            d3.select("svg").remove();
            var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", "translate(" + width / 2 + "," + (height / 2) + ")");

            root = d3.hierarchy(root);
            root.sum(function (d) {
                return d.values;
            });

            function click(d) {
                svg.transition()
                    .duration(750)
                    .tween("scale", function() {
                        var xd = d3.interpolate(x.domain(), [d.x0, d.x1]),
                            yd = d3.interpolate(y.domain(), [d.y0, 1]),
                            yr = d3.interpolate(y.range(), [d.y0 ? 20 : 0, radius]);
                        return function(t) { x.domain(xd(t)); y.domain(yd(t)).range(yr(t)); };
                    })
                    .selectAll("path")
                    .attrTween("d", function(d) { return function() { return arc(d); }; });
            }

            svg.selectAll("path")
                .data(partition(root).descendants())
                .enter().append("path")
                .attr("d", arc)
                .on("click", click)
                .style("fill", function (d) {return color((d.children ? d : d.parent).data.name);})
                .append("title")
                .text(function (d) {return d.data.name + "\n" + formatNumber(d.value);});

        });

    }

    d3.select(self.frameElement).style("height", height + "px");
</script>
